Starting Job
/users/sista/kkontras/Documents/Epilepsy_Challenge/irregulars_neureka_codebase/main.py
/esat/smcdata/users/kkontras/Image_Dataset/no_backup/envs/ec_p10/bin/python
Python 3.10.16
/users/sista/kkontras/Documents/Epilepsy_Challenge/irregulars_neureka_codebase
We have 1 GPU
/users/sista/kkontras/Documents/Epilepsy_Challenge/irregulars_neureka_codebase/main.py
config-./configs/unet_raw.json
Executing command: python3 /users/sista/kkontras/Documents/Epilepsy_Challenge/irregulars_neureka_codebase/main.py --config ./configs/unet_raw.json --default_config ./configs/default_config_tuhsz2.json --rsz 0.5 --lr 0.001 --wd 0.0001 --bs 32
Namespace(config='./configs/unet_raw.json', default_config='./configs/default_config_tuhsz2.json', lr='0.001', wd='0.0001', mm=None, rsz='0.5', bs='32', post_validate=False, print_results=False)
2025-02-14 19:10:39,779 - Config - INFO - ./configs/unet_raw.json
2025-02-14 19:10:39,782 - Config - INFO -  THE Configuration of your experiment ..
{'dataset': {'data_path': {'sz2': '/esat/biomeddata/mbhaguba/seizeit2.h5',
                           'tuh': '/esat/biomeddata/kkontras/TUH/tuh_eeg/tuh_eeg_seizure/v2.0.3/TUH.h5'},
             'dataloader_class': 'TUHSeizIT2_Dataloader',
             'discard_full_prob': 1.0,
             'fs': 200,
             'ratio_sz_nsz': 0.5,
             'stride': 4096,
             'window_size': 4096},
 'early_stopping': {'max_epoch': 150,
                    'n_steps_stop': 50,
                    'n_steps_stop_after': 0},
 'exp_name': 'TUH + SeizIT2 Experiment',
 'model': {'args': {'augment_with_surrogates': False},
           'encoders': [{'args': {'n_channels': 18,
                                  'n_filters': 8,
                                  'preproc': 'raw',
                                  'window_size': 4096},
                         'model_class': 'UNet1D',
                         'pretrainedEncoder': {'dir': 'neureka_pytorch_raw.pth',
                                               'use': True}}],
           'load_ongoing': True,
           'model_class': 'Unimodal',
           'save_base_dir': '/esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/',
           'save_dir': 'unet_raw{}.pth'},
 'optimizer': {'beta1': 0.9,
               'beta2': 0.999,
               'lr': 0.001,
               'type': 'Adam',
               'weight_decay': 0.0001},
 'scheduler': {'T_0': 10, 'T_mult': 1, 'type': 'CosineAnnealingWarmRestarts'},
 'training_params': {'batch_size': 128,
                     'cuda': True,
                     'data_loader_workers': 8,
                     'gpu_device': [0],
                     'pin_memory': True,
                     'seed': 109,
                     'tdqm_disable': True,
                     'test_batch_size': 128,
                     'wandb_disable': True}}
2025-02-14 19:10:39,782 - Config - INFO -  *************************************** 
2025-02-14 19:10:39,782 - Config - INFO - The experiment name is TUH + SeizIT2 Experiment
2025-02-14 19:10:39,782 - Config - INFO -  *************************************** 
We discard non-seizure recordings: train
Number of patients before:  471
Number of patients after:  231
We discard randomly further 114062 non-seizure windows
We discard non-seizure recordings: val
Number of patients before:  118
Number of patients after:  60
We discard non-seizure recordings: test
Number of patients before:  0
Number of patients after:  0
Available cores 8
We are changing dataloader workers to num of cores 7
Loading encoder from /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/neureka_pytorch_raw.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 0 step 2893 with 
Type of results: sample_results 
sensitivity : 0.104 sensitivity_std : 0.199 precision : 0.574 precision_std : 0.441 f1 : 0.206 f1_std : 0.249 fpRate : 2179.373 fpRate_std : 8279.322 
Type of results: event_results 
sensitivity : 0.270 sensitivity_std : 0.362 precision : 0.805 precision_std : 0.318 f1 : 0.623 f1_std : 0.289 fpRate : 13.444 fpRate_std : 44.283 

[37mNew best model found!
[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 1 step 2893 with 
Type of results: sample_results 
sensitivity : 0.340 sensitivity_std : 0.331 precision : 0.373 precision_std : 0.338 f1 : 0.289 f1_std : 0.276 fpRate : 10936.197 fpRate_std : 18279.259 
Type of results: event_results 
sensitivity : 0.553 sensitivity_std : 0.438 precision : 0.529 precision_std : 0.383 f1 : 0.529 f1_std : 0.360 fpRate : 52.778 fpRate_std : 66.808 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 2 step 2893 with 
Type of results: sample_results 
sensitivity : 0.223 sensitivity_std : 0.268 precision : 0.476 precision_std : 0.398 f1 : 0.251 f1_std : 0.243 fpRate : 5250.632 fpRate_std : 12624.208 
Type of results: event_results 
sensitivity : 0.454 sensitivity_std : 0.420 precision : 0.600 precision_std : 0.382 f1 : 0.555 f1_std : 0.340 fpRate : 32.347 fpRate_std : 61.275 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 3 step 2893 with 
Type of results: sample_results 
sensitivity : 0.280 sensitivity_std : 0.302 precision : 0.454 precision_std : 0.365 f1 : 0.305 f1_std : 0.276 fpRate : 4588.530 fpRate_std : 11686.297 
Type of results: event_results 
sensitivity : 0.512 sensitivity_std : 0.418 precision : 0.549 precision_std : 0.393 f1 : 0.534 f1_std : 0.362 fpRate : 37.219 fpRate_std : 59.494 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 4 step 2893 with 
Type of results: sample_results 
sensitivity : 0.259 sensitivity_std : 0.291 precision : 0.378 precision_std : 0.355 f1 : 0.269 f1_std : 0.253 fpRate : 5273.176 fpRate_std : 12536.229 
Type of results: event_results 
sensitivity : 0.533 sensitivity_std : 0.429 precision : 0.506 precision_std : 0.395 f1 : 0.501 f1_std : 0.374 fpRate : 45.581 fpRate_std : 64.707 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 5 step 2893 with 
Type of results: sample_results 
sensitivity : 0.453 sensitivity_std : 0.343 precision : 0.324 precision_std : 0.315 f1 : 0.310 f1_std : 0.265 fpRate : 11216.363 fpRate_std : 16062.109 
Type of results: event_results 
sensitivity : 0.701 sensitivity_std : 0.390 precision : 0.456 precision_std : 0.362 f1 : 0.503 f1_std : 0.357 fpRate : 76.385 fpRate_std : 76.240 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 6 step 2893 with 
Type of results: sample_results 
sensitivity : 0.752 sensitivity_std : 0.298 precision : 0.202 precision_std : 0.246 f1 : 0.271 f1_std : 0.281 fpRate : 37739.783 fpRate_std : 20821.918 
Type of results: event_results 
sensitivity : 0.944 sensitivity_std : 0.201 precision : 0.431 precision_std : 0.339 f1 : 0.518 f1_std : 0.358 fpRate : 154.664 fpRate_std : 91.906 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 7 step 2893 with 
Type of results: sample_results 
sensitivity : 0.476 sensitivity_std : 0.364 precision : 0.290 precision_std : 0.310 f1 : 0.302 f1_std : 0.292 fpRate : 13683.460 fpRate_std : 17332.564 
Type of results: event_results 
sensitivity : 0.683 sensitivity_std : 0.414 precision : 0.463 precision_std : 0.380 f1 : 0.507 f1_std : 0.387 fpRate : 83.000 fpRate_std : 79.744 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 8 step 2893 with 
Type of results: sample_results 
sensitivity : 0.287 sensitivity_std : 0.318 precision : 0.504 precision_std : 0.371 f1 : 0.341 f1_std : 0.287 fpRate : 4612.779 fpRate_std : 12049.245 
Type of results: event_results 
sensitivity : 0.474 sensitivity_std : 0.423 precision : 0.618 precision_std : 0.376 f1 : 0.586 f1_std : 0.338 fpRate : 27.490 fpRate_std : 57.241 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 9 step 2893 with 
Type of results: sample_results 
sensitivity : 0.283 sensitivity_std : 0.311 precision : 0.437 precision_std : 0.365 f1 : 0.308 f1_std : 0.268 fpRate : 5870.085 fpRate_std : 13234.719 
Type of results: event_results 
sensitivity : 0.514 sensitivity_std : 0.438 precision : 0.587 precision_std : 0.411 f1 : 0.575 f1_std : 0.384 fpRate : 37.673 fpRate_std : 70.456 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 10 step 2893 with 
Type of results: sample_results 
sensitivity : 0.195 sensitivity_std : 0.262 precision : 0.516 precision_std : 0.387 f1 : 0.285 f1_std : 0.271 fpRate : 2946.656 fpRate_std : 10330.653 
Type of results: event_results 
sensitivity : 0.430 sensitivity_std : 0.417 precision : 0.626 precision_std : 0.375 f1 : 0.551 f1_std : 0.333 fpRate : 23.638 fpRate_std : 42.339 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 11 step 2893 with 
Type of results: sample_results 
sensitivity : 0.566 sensitivity_std : 0.352 precision : 0.272 precision_std : 0.277 f1 : 0.309 f1_std : 0.275 fpRate : 19824.147 fpRate_std : 21171.077 
Type of results: event_results 
sensitivity : 0.792 sensitivity_std : 0.342 precision : 0.455 precision_std : 0.345 f1 : 0.521 f1_std : 0.348 fpRate : 96.693 fpRate_std : 81.065 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 12 step 2893 with 
Type of results: sample_results 
sensitivity : 0.348 sensitivity_std : 0.341 precision : 0.358 precision_std : 0.338 f1 : 0.295 f1_std : 0.283 fpRate : 8044.896 fpRate_std : 14404.966 
Type of results: event_results 
sensitivity : 0.583 sensitivity_std : 0.412 precision : 0.530 precision_std : 0.399 f1 : 0.529 f1_std : 0.369 fpRate : 52.145 fpRate_std : 68.974 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 13 step 2893 with 
Type of results: sample_results 
sensitivity : 0.290 sensitivity_std : 0.323 precision : 0.426 precision_std : 0.354 f1 : 0.289 f1_std : 0.271 fpRate : 5239.143 fpRate_std : 12107.445 
Type of results: event_results 
sensitivity : 0.508 sensitivity_std : 0.414 precision : 0.570 precision_std : 0.382 f1 : 0.543 f1_std : 0.345 fpRate : 34.079 fpRate_std : 52.248 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 14 step 2893 with 
Type of results: sample_results 
sensitivity : 0.460 sensitivity_std : 0.356 precision : 0.321 precision_std : 0.329 f1 : 0.316 f1_std : 0.294 fpRate : 13664.643 fpRate_std : 18617.375 
Type of results: event_results 
sensitivity : 0.687 sensitivity_std : 0.393 precision : 0.489 precision_std : 0.373 f1 : 0.529 f1_std : 0.368 fpRate : 72.543 fpRate_std : 76.964 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 15 step 2893 with 
Type of results: sample_results 
sensitivity : 0.332 sensitivity_std : 0.328 precision : 0.415 precision_std : 0.368 f1 : 0.293 f1_std : 0.262 fpRate : 6772.279 fpRate_std : 13629.153 
Type of results: event_results 
sensitivity : 0.551 sensitivity_std : 0.417 precision : 0.523 precision_std : 0.393 f1 : 0.512 f1_std : 0.368 fpRate : 42.303 fpRate_std : 59.944 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 16 step 2893 with 
Type of results: sample_results 
sensitivity : 0.334 sensitivity_std : 0.326 precision : 0.382 precision_std : 0.345 f1 : 0.308 f1_std : 0.263 fpRate : 6565.908 fpRate_std : 13024.014 
Type of results: event_results 
sensitivity : 0.568 sensitivity_std : 0.418 precision : 0.515 precision_std : 0.397 f1 : 0.527 f1_std : 0.370 fpRate : 46.643 fpRate_std : 67.434 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 17 step 2893 with 
Type of results: sample_results 
sensitivity : 0.566 sensitivity_std : 0.359 precision : 0.266 precision_std : 0.286 f1 : 0.306 f1_std : 0.293 fpRate : 19725.437 fpRate_std : 19619.722 
Type of results: event_results 
sensitivity : 0.786 sensitivity_std : 0.368 precision : 0.449 precision_std : 0.364 f1 : 0.515 f1_std : 0.371 fpRate : 112.640 fpRate_std : 86.539 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 18 step 2893 with 
Type of results: sample_results 
sensitivity : 0.323 sensitivity_std : 0.314 precision : 0.404 precision_std : 0.353 f1 : 0.317 f1_std : 0.275 fpRate : 6389.009 fpRate_std : 13042.811 
Type of results: event_results 
sensitivity : 0.572 sensitivity_std : 0.431 precision : 0.534 precision_std : 0.380 f1 : 0.552 f1_std : 0.364 fpRate : 47.258 fpRate_std : 65.451 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 19 step 2893 with 
Type of results: sample_results 
sensitivity : 0.305 sensitivity_std : 0.314 precision : 0.400 precision_std : 0.353 f1 : 0.306 f1_std : 0.275 fpRate : 5671.096 fpRate_std : 12067.121 
Type of results: event_results 
sensitivity : 0.547 sensitivity_std : 0.422 precision : 0.535 precision_std : 0.386 f1 : 0.543 f1_std : 0.362 fpRate : 41.329 fpRate_std : 60.430 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 20 step 2893 with 
Type of results: sample_results 
sensitivity : 0.287 sensitivity_std : 0.299 precision : 0.469 precision_std : 0.347 f1 : 0.334 f1_std : 0.261 fpRate : 4762.839 fpRate_std : 11598.496 
Type of results: event_results 
sensitivity : 0.530 sensitivity_std : 0.408 precision : 0.629 precision_std : 0.352 f1 : 0.607 f1_std : 0.313 fpRate : 28.843 fpRate_std : 51.343 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 21 step 2893 with 
Type of results: sample_results 
sensitivity : 0.351 sensitivity_std : 0.328 precision : 0.352 precision_std : 0.347 f1 : 0.305 f1_std : 0.284 fpRate : 7618.608 fpRate_std : 13159.473 
Type of results: event_results 
sensitivity : 0.613 sensitivity_std : 0.423 precision : 0.508 precision_std : 0.383 f1 : 0.528 f1_std : 0.374 fpRate : 48.423 fpRate_std : 60.400 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
Label percentage 0: 0.98% 1: 0.02%
val Epoch 22 step 2893 with 
Type of results: sample_results 
sensitivity : 0.333 sensitivity_std : 0.326 precision : 0.399 precision_std : 0.361 f1 : 0.308 f1_std : 0.274 fpRate : 6718.039 fpRate_std : 13398.286 
Type of results: event_results 
sensitivity : 0.542 sensitivity_std : 0.420 precision : 0.505 precision_std : 0.377 f1 : 0.520 f1_std : 0.365 fpRate : 54.238 fpRate_std : 92.200 

[37mModels has saved successfully in /esat/smcdata/users/kkontras/Image_Dataset/no_backup/data/2023_data/TUH_SZ2_models/unet_raw_lr0.001_wd0.0001_rsz0.5_rsz32.pth
